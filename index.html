<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,700&display=swap&subset=cyrillic" rel="stylesheet">
  <link rel="stylesheet" href="./style.css">
</head>
<body>
  <div id="calc-app">
    <div class="tabs">
    
      <transition name="scale" mode="out-in">
        <div :class="currentStep === '1' ? 'active-tab' : ''" v-if="currentStep === '1'" class="tab step-1">
          <h2 class="tab-title">Укажите пол вашего ребенка</h2>
          <div class="choosing">
            <div @click="CHOOSING_sex('sex-1')" :class="info.sex === 'sex-1' ? 'active' : ''" class="item">
              <img ondragstart="return false" src="./images/man.svg" alt="">
            </div>
            <div @click="CHOOSING_sex('sex-2')" :class="info.sex === 'sex-2' ? 'active' : ''" class="item">
              <img ondragstart="return false" src="./images/woman.svg" alt="">
            </div>
          </div>
          <button :disabled="!info.sex || !isUnBlock" @click="nextStep('2')" class="btn-next">Дальше</button>
        </div>
      </transition>

      <transition name="scale" mode="out-in">
        <div :class="currentStep === '2' ? 'active-tab' : ''" v-if="currentStep === '2'" class="tab step-2">
          <h2 class="tab-title">Возраст пациента?</h2>
          <div class="tab-slider">
            <input class="tab-slider-input" v-model="info.age" type="range" min="5" :max="info.sex === 'sex-1' ? 17 : 16">
          </div>
          <p class="slider-value">
            {{ info.age }} лет
          </p>
          <button @click="nextStep('3')" class="btn-next">Дальше</button>
        </div>
      </transition>

      <transition name="scale" mode="out-in">
        <div :class="currentStep === '3' ? 'active-tab' : ''" v-if="currentStep === '3'" class="tab step-3">
          <h2 class="tab-title">Факторы риска?</h2>
          <div class="choosing choosing-risks">
            <div @click="CHOOSING_riskFactors('1')" :class="info.risksFactors.find(i => i === '1') ? 'active-risks' : ''" class="main-item">
              <div class="item">
                <img ondragstart="return false" src="./images/risk-factors/1.svg" alt="">
              </div>
              <p class="item-desc">Время, ежедневно проводимое на открытом воздухе менее 1,5 часов в день</p>
            </div>

            <div @click="CHOOSING_riskFactors('2')" :class="info.risksFactors.find(i => i === '2') ? 'active-risks' : ''" class="main-item">
              <div class="item">
                <img ondragstart="return false" src="./images/risk-factors/2.png" alt="">
              </div>
              <p class="item-desc">Ребенок затрачивает на работу вблизи более 3х часов в день, ежедневно</p>
            </div>

            <div @click="CHOOSING_riskFactors('3')" :class="info.risksFactors.find(i => i === '3') ? 'active-risks' : ''" class="main-item">
              <div class="item">
                <img ondragstart="return false" src="./images/risk-factors/3.svg" alt="">
              </div>
              <p class="item-desc">Длительное использование мобильных девайсов(гаджетов,ПК)</p>
            </div>

            <div @click="CHOOSING_riskFactors('4')" :class="info.risksFactors.find(i => i === '4') ? 'active-risks' : ''" class="main-item">
              <div class="item">
                <img ondragstart="return false" src="./images/risk-factors/4.png" alt="">
              </div>
              <p class="item-desc">У ребенка выявлены аккомодационные нарушения(задержка, слабость аккомодации, низкие показатели ЗОА)</p>
            </div>

            <div @click="CHOOSING_riskFactors('5')" :class="info.risksFactors.find(i => i === '5') ? 'active-risks' : ''" class="main-item">
              <div class="item">
                <img ondragstart="return false" src="./images/risk-factors/5.png" alt="">
              </div>
              <p class="item-desc">У ребенка выявлены бинокулярные нарушения(экзофория, аккомодационная экзотропия, высокое соотношение АК\А)</p>
            </div>

            <div @click="CHOOSING_riskFactors('6')" :class="info.risksFactors.find(i => i === '6') ? 'active-risks' : ''" class="main-item">
              <div class="item">
                <img ondragstart="return false" src="./images/risk-factors/6.svg" alt="">
              </div>
              <p class="item-desc">Наследственность</p>
            </div>

            <div @click="CHOOSING_riskFactors('7')" :class="info.risksFactors.find(i => i === '7') ? 'active-risks' : ''" class="main-item">
              <div class="item">
                <img ondragstart="return false" src="./images/risk-factors/7.png" alt="">
              </div>
              <p class="item-desc">Возраст выявления близорукости менее(или равен) 7 годам</p>
            </div>
          </div>
          <button @click="nextStep('4')" class="btn-next">Дальше</button>
        </div>
      </transition>

      <transition name="scale" mode="out-in">
        <div :class="currentStep === '4' ? 'active-tab' : ''" v-if="currentStep === '4'" class="tab step-4">
          <h2 class="tab-title">Какой из указанных способов коррекции близорукости и\или контроля используется?</h2>
          <div class="choosing choosing-risks">
            <div @click="CHOOSING_controlMethods('1')" :class="info.controlMethods === '1' ? 'active-risks' : ''" class="main-item">
              <div class="item">
                <img ondragstart="return false" src="./images/control-methods/1.png" alt="">
              </div>
              <p class="item-desc">Ортокератологические линзы(ночные линзы)</p>
            </div>
            <div @click="CHOOSING_controlMethods('2')" :class="info.controlMethods === '2' ? 'active-risks' : ''" class="main-item">
              <div class="item">
                <img ondragstart="return false" src="./images/control-methods/2.png" alt="">
              </div>
              <p class="item-desc">Бифокальные контактные линзы</p>
            </div>
            <div @click="CHOOSING_controlMethods('3')" :class="info.controlMethods === '3' ? 'active-risks' : ''" class="main-item">
              <div class="item">
                <img ondragstart="return false" src="./images/control-methods/3.png" alt="">
              </div>
              <p class="item-desc">Очковая коррекция или коррекция не используется</p>
            </div>
          </div>
          <button :disabled="!info.controlMethods" @click="nextStep('5')" class="btn-next">Дальше</button>
        </div>
      </transition>

      <transition name="scale" mode="out-in">
        <div :class="currentStep === '5' ? 'active-tab' : ''" v-if="currentStep === '5'" class="tab step-5">
          <h2 class="tab-title">На каком глазу близорукость у ребенка?</h2>
          <div class="choosing choosing-eyes">
            <div @click="CHOOSING_eye('left')" :class="info.eye.left.isTrue ? 'active-risks' : ''" class="main-item">
              <div class="item">
                <img ondragstart="return false" src="./images/eye.svg" alt="">
              </div>
              <p class="item-desc">Левый глаз</p>
            </div>
        
            <div @click="CHOOSING_eye('right')" :class="info.eye.right.isTrue ? 'active-risks' : ''" class="main-item">
              <div class="item">
                <img ondragstart="return false" src="./images/eye.svg" alt="">
              </div>
              <p class="item-desc">Правый глаз</p>
            </div>
          </div>

          <button :disabled="!info.eye.left.isTrue && !info.eye.right.isTrue" @click="nextStepChoosingEye" class="btn-next">Дальше</button>
        </div>
      </transition>

      <transition name="scale" mode="out-in">
        <div :class="currentStep === '6' ? 'active-tab' : ''" v-if="currentStep === '6'" class="tab step-6">
          <h2 class="tab-title">Какова степень близорукости(дптр)?</h2>
          <div v-if="currentEye === 'left'">
            <p class="subtitle">Для левого глаза</p>
            <input class="input-numb" min="0" max="10" placeholder="3.00" @input="formatting($event.target, 'left', 'myopia')" :value="info.eye.left.myopia"
              type="number" name="">
          </div>
        
          <div v-if="currentEye === 'right'">
            <p class="subtitle">Для правого глаза</p>
            <input class="input-numb" min="0" max="10" placeholder="3.00" @input="formatting($event.target, 'right', 'myopia')"
              :value="info.eye.right.myopia" type="number" name="">
          </div>

          <button @click="nextStep('7')" class="btn-next">Дальше</button>
        </div>
      </transition>

      <transition name="scale" mode="out-in">
        <div :class="currentStep === '7' ? 'active-tab' : ''" v-if="currentStep === '7'" class="tab step-7">
          <h2 class="tab-title">Укажите значение аксиального размера глаза(мм)?</h2>
          <div v-if="currentEye === 'left'">
            <p class="subtitle">Для левого глаза</p>
            <input class="input-numb" min="23" max="40" placeholder="23.00" @input="formatting($event.target, 'left', 'eyeSize')"
              :value="info.eye.left.eyeSize" type="number" name="">
          </div>
        
          <div v-if="currentEye === 'right'">
            <p class="subtitle">Для правого глаза</p>
            <input class="input-numb" min="23" max="40" placeholder="23.00" @input="formatting($event.target, 'right', 'eyeSize')"
              :value="info.eye.right.eyeSize" type="number" name="">
          </div>

          <button @click="nextStep('8')" class="btn-next">Дальше</button>
        </div>
      </transition>

      <transition name="scale" mode="out-in">
        <div :class="currentStep === '8' ? 'active-tab' : ''" v-if="currentStep === '8'" class="tab step-8">
          <h2 class="tab-title">Укажите показатели кератометрии (Км)?</h2>
          <div v-if="currentEye === 'left'">
            <p class="subtitle">Для левого глаза</p>
            <input class="input-numb" min="43" max="60" placeholder="43.00" @input="formatting($event.target, 'left', 'keratometries')"
              :value="info.eye.left.keratometries" type="number" name="">
          </div>
        
          <div v-if="currentEye === 'right'">
            <p class="subtitle">Для правого глаза</p>
            <input class="input-numb" min="43" max="60" placeholder="43.00" @input="formatting($event.target, 'right', 'keratometries')"
              :value="info.eye.right.keratometries" type="number" name="">
          </div>

          <button @click="nextStep('9')" class="btn-next">Дальше</button>
        </div>
      </transition>

      <transition name="scale" mode="out-in">
        <div :class="currentStep === '9' ? 'active-tab' : ''" v-if="currentStep === '9'" class="tab step-9">
          <h2 class="tab-title">Известен ли вам годовой прирост аксиального размера глаза?</h2>
          <div v-if="currentEye === 'left'">
            <p class="subtitle">Для левого глаза</p>
            <div class="btns-wrapper">
              <button @click="info.eye.left.annualIncr = true" :class="info.eye.left.annualIncr ? 'btn-quest-active' : ''"
                class="btn-quest">
                Да
              </button>
              <button @click="info.eye.left.annualIncr = false" :class="!info.eye.left.annualIncr ? 'btn-quest-active' : ''"
                class="btn-quest">
                Нет
              </button>
            </div>
            <input v-if="info.eye.left.annualIncr" class="input-numb" min="0" max="10" placeholder="00.40"
              @input="formatting($event.target, 'left', 'annualIncrNumb')" :value="info.eye.left.annualIncrNumb" type="number"
              name="">
            <div @click="chooseEyeAndStep('right', '6')" v-if="!info.eye.right.isTrue" class="eye">
              <div class="item">
                <img ondragstart="return false" src="./images/eye.svg" alt="">
              </div>
              <p class="item-desc">Заполнить данные правого глаза</p>
            </div>
            
            <button v-if="info.eye.right.isTrue && isBoth" @click="continueMethod" class="btn-quest btn-last">Далее</button>
            <button v-else @click="areYouSure" class="btn-quest btn-last">Рассчитать</button>
          </div>


          <div v-if="currentEye === 'right'">
            <p class="subtitle">Для правого глаза</p>
            <div class="btns-wrapper">
              <button @click="info.eye.right.annualIncr = true" :class="info.eye.right.annualIncr ? 'btn-quest-active' : ''"
                class="btn-quest">
                Да
              </button>
              <button @click="info.eye.right.annualIncr = false" :class="!info.eye.right.annualIncr ? 'btn-quest-active' : ''"
                class="btn-quest">
                Нет
              </button>
          
            </div>
            <input v-if="info.eye.right.annualIncr" class="input-numb" min="0" max="10" placeholder="00.40"
              @input="formatting($event.target, 'right', 'annualIncrNumb')" :value="info.eye.right.annualIncrNumb" type="number"
              name="">
            <div @click="chooseEyeAndStep('left', '6')" v-if="!info.eye.left.isTrue" class="eye">
              <div class="item">
                <img ondragstart="return false" src="./images/eye.svg" alt="">
              </div>
              <p class="item-desc">Заполнить данные левого глаза</p>
            </div>
            <button @click="areYouSure" class="btn-quest btn-last">Рассчитать</button>
          </div>
        </div>
      </transition>

      <div :class="currentEye === 'graph' && currentStep === 'graph' ? 'active-tab' : ''" v-if="currentEye === 'graph' && currentStep === 'graph'" class="charts">
        <h3>Данные ПЗО</h3>
        <line-chart @refractio-method="refractioMethod" :info="info"></line-chart>
        <h3>Данные рефракции</h3>
        <line-chart-refractio :info="info"></line-chart-refractio>
        <button @click="toStart" class="btn-quest btn-last-2 btn-last">Вернуться</button>
      </div>
    </div>
    <div :class="isModal.last ? 'activeModal' : ''" @click.self="isModal.last = false" class="modal-bg" v-show="isModal.last">
      <transition name="scale" mode="out-in">
        <div class="modal" v-show="isModal.last">
          <p class="modal-title">Просим обратить внимание!</p>
          <p class="text">Расчетные значения калькулятора могут отличаться от реальной скорости прогрессирования
            близорукости у вашего ребенка под
            влиянием различных факторов.</p>
          <button @click="calculate" class="btn-quest btn-modal">Готово</button>
        </div>
      </transition>
    </div>

    <div :class="isModal.first ? 'activeModal' : ''" @click.self="isModal.first = false" class="modal-bg" v-show="isModal.first">
      <transition name="scale" mode="out-in">
        <div class="modal" v-show="isModal.first">
          <p class="modal-title">Инструкция по заполнению полей калькулятора для прогнозирования прогрессирования близорукости.</p>
          <p class="text">Перед началом расчета степени прогрессирования близорукости Вашего ребенка, пожалуйста, ознакомьтесь с
            данной
            инструкцией.​</p>
          <p class="text">Полученный результат не является диагнозом и может отличаться от реальной степени прогрессирования близорукости у Вашего
          ребенка. Полученные данные вы можете обсудить со своим врачом-офтальмологом.​​</p>
          <p class="text">При заполнении учитываются неконтролируемые (наследственность) контролируемые факторы риска, такие как нагрузка вблизи,
          использование электронных гаджетов и др. Эти риски способствуют прогрессированию близорукости.​​</p>
          <p class="text">Использования некоторых методов коррекции, таких как ортокератологические (ночные) или бифокальные (дефокусные)
          контактные линзы достоверно снижают риск прогрессирования миопии*. Если Ваш ребенок использует их, отметьте это. Если он
          использует другие методы коррекции или не использует их, то выберите соответствующую кнопку (иконку, не знаю как
          назвать).​​</p> 
          <p class="text">Для расчета прогнозирования важно знать существующую степень миопии; аксиальную (осевую) длину глаза (ПЗО), которую
          можно определить доступным методом оптической биометрии; оптическую силу роговицы, которую можно определить методом
          автрорефкератометрии. Эти данные очень важны для оценки состояния близорукости у Вашего ребенка и прогнозирования её
          прогрессирования. Обратитесь к своему врачу-офтальмологу для определения этих показателей.​​​</p> 
          <p class="text">Основным фактором прогрессирования миопии является аксиальное (осевое) удлинение глаза (ПЗО). В норме у здорового
          ребенка в зависимости от возраста глазное яблоко удлиняется на 0,1- 0,3 мм в год. Оценить удлинение можно, ежегодно
          определяя ПЗО. Если у вас есть данные ПЗО за последние 12 месяцев, Вы можете вычислить годовой прирост длины глаза и
          указать значение в соответствующей графе. Если таких данных нет, то рекомендуем Вам осуществлять мониторинг длины глаза
          в будущем.​​​</p> 
          <p class="text">В результате расчета вы получите прогноз изменения степени близорукости и прогноз удлинения глазного яблока. Эти данные
          помогут Вам понять перспективу развития близорукости у Вашего ребенка. Помните, что сегодня существуют эффективные
          методы лечения прогрессирующей близорукости, которые позволяют затормозить рост глаза и увеличение степени миопии.
          Постоянное наблюдение у квалифицированного врача-офтальмолога позволит разработать индивидуальный для Вашего ребенка
          план лечения и профилактические меры.​​​</p>
          <p class="text">Найти врача-офтальмолога можно на нашем сайте в разделе «Найти специалиста», или Вы можете обратиться к
          врачу-офтальмологу по месту жительства или рекомендации.​​​</p>
          <button @click="unblock" class="btn-quest btn-modal">Ознакомлен</button>
        </div>
      </transition>
    </div>
  </div>


  <script src="https://unpkg.com/vue"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.1/Chart.min.js"></script>
  <script src="https://unpkg.com/vue-chartjs/dist/vue-chartjs.min.js"></script>
  <script src="scripts.js"></script>
</body>
</html>